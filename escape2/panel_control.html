<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .simulation-area {
            width: 95%;
            height: 350px;
            background-color: #F0F0F0;
            position: relative;
            border: 2px solid #000;
            overflow: hidden;
            margin-top: 20px;
        }

        .molecule {
            position: absolute;
            z-index: 2;
            width: 50px;  /* Ajusta esto según tus necesidades */
            height: auto;  /* Mantiene la proporción de la imagen */
        }

        .solve-button[disabled] {
            background-color: #999;
            cursor: not-allowed;
        }

        .molecule-label {
            position: absolute;
            font-size: 12px;
            color: #000;
            background-color: #FFF;
            padding: 2px 5px;
            border-radius: 3px;
            z-index: 1;
        }

        ul {
            list-style-type: none;
            padding-left: 0;
        }

        .molecule-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .molecule-item img {
            width: 20px;
            height: 20px;
            margin-left: 10px;
            display: none; /* Ocultar el tick inicialmente */
        }

        .molecule-item.completed img {
            display: inline; /* Mostrar el tick cuando se complete la molécula */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Panel de Control</h1>
        <p>Debes crear las siguientes moléculas:</p>
        <ul>
            <li class="molecule-item" id="agua-item">Agua<img src="media/tick.png" alt="Completado"></li>
            <li class="molecule-item" id="dioxido-item">Dióxido de Carbono<img src="media/tick.png" alt="Completado"></li>
            <li class="molecule-item" id="metano-item">Metano<img src="media/tick.png" alt="Completado"></li>
            <li class="molecule-item" id="amoniaco-item">Amoniaco<img src="media/tick.png" alt="Completado"></li>
        </ul>
        <div>
            <label>Carbono (C):</label>
            <input type="number" id="carbon" min="0" max="4" value="0">
            <label>Oxígeno (O):</label>
            <input type="number" id="oxygen" min="0" max="4" value="0">
            <label>Nitrógeno (N):</label>
            <input type="number" id="nitrogen" min="0" max="4" value="0">
            <label>Hidrógeno (H):</label>
            <input type="number" id="hydrogen" min="0" max="4" value="0">
        </div>
        <button class="solve-button" onclick="checkCombination()">Simular</button>

        <div class="simulation-area"></div>

        <button id="nextButton" class="solve-button" onclick="window.location.href='sala_metalica.html'" disabled>Continuar</button>
    </div>
    <script>
        let createdMolecules = [];

        function checkCombination() {
            let carbon = parseInt(document.getElementById("carbon").value) || 0;
            let oxygen = parseInt(document.getElementById("oxygen").value) || 0;
            let nitrogen = parseInt(document.getElementById("nitrogen").value) || 0;
            let hydrogen = parseInt(document.getElementById("hydrogen").value) || 0;

            if (carbon === 0 && oxygen === 1 && nitrogen === 0 && hydrogen === 2) {
                if (!createdMolecules.includes('Agua')) {
                    addMolecule('Agua', 'agua.png');
                    markAsCompleted('agua-item');
                }
            } else if (carbon === 1 && oxygen === 2 && nitrogen === 0 && hydrogen === 0) {
                if (!createdMolecules.includes('Dióxido de Carbono')) {
                    addMolecule('Dióxido de Carbono', 'dioxido.png');
                    markAsCompleted('dioxido-item');
                }
            } else if (carbon === 1 && oxygen === 0 && nitrogen === 0 && hydrogen === 4) {
                if (!createdMolecules.includes('Metano')) {
                    addMolecule('Metano', 'metano.png');
                    markAsCompleted('metano-item');
                }
            } else if (carbon === 0 && oxygen === 0 && nitrogen === 1 && hydrogen === 3) {
                if (!createdMolecules.includes('Amoniaco')) {
                    addMolecule('Amoniaco', 'amoniaco.png');
                    markAsCompleted('amoniaco-item');
                }
            } else {
                alert("¡Combinación incorrecta! Inténtalo de nuevo.");
            }

            // Si ya se crearon las 4 moléculas diferentes, activa el botón "Continuar"
            if (createdMolecules.length === 4) {
                document.getElementById("nextButton").disabled = false;
            }
        }

        function addMolecule(name, imageUrl) {
            const simArea = document.querySelector('.simulation-area');
            const molecule = document.createElement('img');
            molecule.src = `media/${imageUrl}`;
            molecule.classList.add('molecule');
            molecule.alt = name;

            // Colocar la molécula en una posición aleatoria dentro del área de simulación
            molecule.style.left = `${Math.random() * (simArea.offsetWidth - 100)}px`;
            molecule.style.top = `${Math.random() * (simArea.offsetHeight - 100)}px`;

            simArea.appendChild(molecule);
            animateMolecule(molecule);

            createdMolecules.push(name);
        }

        function animateMolecule(molecule) {
            let speed = Math.random() * 2 + 1;
            let directionX = Math.random() < 0.5 ? 1 : -1;
            let directionY = Math.random() < 0.5 ? 1 : -1;

            function move() {
                let x = parseFloat(molecule.style.left);
                let y = parseFloat(molecule.style.top);

                if (x <= 0 || x >= (molecule.parentElement.offsetWidth - molecule.width)) directionX *= -1;
                if (y <= 0 || y >= (molecule.parentElement.offsetHeight - molecule.height)) directionY *= -1;

                molecule.style.left = `${x + speed * directionX}px`;
                molecule.style.top = `${y + speed * directionY}px`;

                requestAnimationFrame(move);
            }

            move();
        }

        function markAsCompleted(itemId) {
            const item = document.getElementById(itemId);
            item.classList.add('completed');
        }
    </script>
</body>
</html>